<% provide(:title, "competency management") %>
<% provide(:page_title, "Competency Management") %>
<% provide(:page_sub_title, "manage competency models") %>
<% provide(:page_icon, "iconfa-sitemap") %>

<% content_for :breadcrumbs do %>
<%= content_tag(:li, "Competency Management") %>
<% end %>

<% content_for :javascript do %>
<script type="text/javascript">
$(function() {
  //$('#datepicker').datepicker();
  $('.accordion').accordion({
      collapsible: true,
      active: false,
      heightStyle: "content",
      header: ".a-header"
  });
});
</script>
<% end %>

<div class="row-fluid">
  <div id="dashboard-left" class="span8">
    <h3 class="subtitle">Competency Model</h3>
    <div class="divider15"></div>
    <h4 class="widgettitle"><span class="iconfa-home"></span> Competency Summary</h4>
    <% if @competencies.size == 0 %>
    <div class="widgetcontent">
      <p>No Competency Model setup yet. please setup it first. </p>
    </div>
    <% else %>
    <div class="widgetcontent nopadding">
      <div class="accordion">
        <% @competencies.each do |c| %>
        <div class="a-header">
          <a href="#"><%= c.name %><span class="pull-right"><%= "created at " + distance_of_time_in_words_to_now(c.created_at) + ' ago' %></span></a>
        </div>
        <div class="a-content">
          <%= content_tag(:h5, "Competency description: " + c.description) %>
          <% c.competency_levels.each do |cl| %>
            <%= content_tag(:h6, "Level " + cl.level.to_s + ": " + cl.description) %>
            <%= content_tag(:p, "Detail Requirements:") %>
            <ul>
            <% cl.competency_level_requirements.each do |clr| %>
            <%= content_tag(:li, clr.description) %>
            <% end %>
            </ul>
          <% end %>
        </div>
        <% end %>
      </div>
    </div>
    <% end %>

    <div class="well">
      <a href="#" class="btn btn-primary disabled"><i class="iconfa-plus icon-white"></i> Create New Competency</a>
      <a href="<%= export_competencies_path(format: "csv") %>" class="btn btn-warning"><i class="iconfa-download-alt icon-white"></i> Export As CSV</a>
    </div>

  </div> <!--span 8-->

  <div id="dashboard-right" class="span4">
    <h3 class="subtitle">Manage Competency</h3>
    <div class="divider15"></div>
    <h4 class="widgettitle"> Import Competency Model</h4>
    <div class="widgetcontent">
      <%= form_tag import_competencies_path, multipart: true do %>
      <div class="fileupload fileupload-new" data-provides="fileupload">
        <div class="input-append">
          <div class="uneditable-input span3">
          <i class="iconfa-file fileupload-exists"></i>
          <span class="fileupload-preview"></span>
          </div>
          <span class="btn btn-file"><span class="fileupload-new">Select file</span>
          <span class="fileupload-exists">Change</span>
          <input class="file optional" id="file" name="file" type="file" /></span>
          <a href="#" class="btn fileupload-exists" data-dismiss="fileupload">Remove</a>
        </div>
      </div>
      <%= submit_tag "Import Competency".html_safe, :class => "btn btn-primary submit-import" %>
      <% end %>
    </div>
  </div>
</div> <!--row-fluid-->